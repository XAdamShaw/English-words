# 一万英语高频词

一个用于学习和管理英语高频词汇的单页应用，支持 CSV 文件导入、评分管理、主题切换等功能。

## 文件结构

```
10000-EngWords/
├── index.html        # 主 HTML 文件（推荐使用）
├── style.css         # 样式文件
├── script.js         # JavaScript 逻辑文件
└── engwords.html     # 单文件版本（所有代码在一个文件中，已废弃）
```

## 功能特点

### 📁 CSV 文件管理
- 支持拖拽或点击上传 CSV 文件
- 自动保存上传历史到本地存储
- 小文件（< 1MB）可从历史记录快速加载
- 大文件（≥ 1MB）需要重新选择（避免超出浏览器存储配额）
- 智能错误处理，防止存储溢出

### ⭐ 评分系统
- 为每个词条打 0-5 星评分
- 评分数据持久化保存
- 卡片自动按评分排序显示

### 🔊 语音朗读
- 基于浏览器内置 SpeechSynthesis API
- 点击 🔊 按钮朗读单词发音
- 支持自动停止重复播放
- 朗读中脉冲动画反馈
- 响应时间 < 100ms

### 🎨 主题切换
- 提供 4 种内置主题：
  - 渐变蓝紫（默认）
  - 纯白色
  - 浅灰色
  - 深色模式
- 主题偏好自动保存

### 📜 滚动导航
- 滑块控制快速定位
- 输入行号精确跳转
- 实时显示当前位置
- 自动跟踪滚动位置
- 智能滚动动画（小数据集 0.5s 平滑，大数据集即时跳转）

### 👁️ 视图切换
- 一键隐藏/显示固定导航栏
- 完全移除占位空间，内容自动填充
- 悬浮按钮快速恢复
- 平滑过渡动画（300ms）
- 状态自动保存
- 详见：[Header 隐藏优化文档](HEADER_HIDE_FIX.md)

### 🎚️ 字段显示控制
- Toggle 开关控制释义（definition）显示/隐藏
- Toggle 开关控制例句（sentence）显示/隐藏
- 独立控制，互不影响
- 平滑淡入淡出动画（300ms）
- 卡片高度自动调整
- 状态持久化保存
- 详见：[字段显示控制文档](FIELD_TOGGLE_FEATURE.md)

### ☁️ 云端数据同步
- 接入 JSONBin.io 实现跨设备同步
- 自动同步星级评分到云端
- 同步筛选和排序设置
- 保存和恢复上次浏览位置（lastViewedRow）
- 实时显示同步状态（Synced/Not Synced/⚠️）
- 批量云端数据回显，性能提升20-60倍
- 星级评分从云端恢复后自动更新UI
- 三层缓存机制（内存+localStorage+云端）
- 离线模式支持，网络恢复自动同步
- 新设备自动恢复学习进度和浏览位置
- 加载提示和进度反馈
- 详见：
  - [云端同步功能文档](CLOUD_SYNC_FEATURE.md)
  - [云端数据回显补强文档](CLOUD_DATA_RESTORE.md)

### 🔍 筛选与排序
- 按星级筛选单词（0-5星或全部）
- 切换星级排序/原始顺序
- 设置自动同步到云端
- 实时生效，无需刷新

### 📱 响应式设计
- 适配桌面、平板、手机
- 断点：820px、520px
- 触摸友好的交互

## 使用方法

### 启动应用
直接在浏览器中打开 `index.html` 即可使用，无需服务器。

### CSV 格式要求
- 第一行为标题行（用于字段名映射）
- 支持逗号分隔
- 支持引号包裹的字段
- 标准格式（推荐字段名）：
  ```csv
  id,frequency,word,phoneticSymbol,definition,sentence
  0,1000,abandon,/əˈbændən/,放弃；遗弃,Don't abandon hope.
  1,999,ability,/əˈbɪləti/,能力；才能,He has the ability to succeed.
  ```

#### 字段说明
- `id`: 行标识符（从0开始，用于显示行号）
- `frequency`: 词频（显示在右上角）
- `word`: 单词（主内容，用于朗读）
- `phoneticSymbol`: 音标（可选）
- `definition`: 中文释义（可选）
- `sentence`: 例句（可选）

详见：[CSV 字段名访问文档](CSV_FIELD_NAME_ACCESS.md)

### 评分管理
1. 点击卡片右侧的星星进行评分
2. 点击"取消"可重置评分
3. 高分卡片自动排在前面

### 滚动导航
- **拖动滑块**：预览行号（不滚动），松开后跳转
- **输入行号 + Go**：直接跳转到指定行
- **手动滚动**：滑块和行号信息自动更新

### 语音朗读
- **点击 🔊 按钮**：朗读当前卡片的单词（第二列内容）
- **自动停止**：点击新按钮时自动停止之前的朗读
- **视觉反馈**：朗读中按钮会有脉冲动画效果
- **浏览器支持**：Chrome ≥100、Edge ≥100、Safari ≥15、Firefox ≥100
- **性能监测**：所有性能数据在浏览器控制台可见

## 技术栈

- **纯原生实现**：HTML5 + CSS3 + Vanilla JavaScript
- **无依赖**：不依赖任何第三方库
- **本地存储**：使用 localStorage 持久化数据
- **性能优化**：
  - 批次渲染（每批 100 条）
  - 虚拟滚动（按需加载）
  - 自动加载更多
  - DocumentFragment 批量插入
  - 防抖处理滚动事件
  - 大数据集自动降级为即时跳转

## 浏览器兼容性

### 桌面端
- Chrome >= 100
- Safari >= 15
- Edge >= 100
- Firefox >= 100

### 移动端
- Chrome Mobile >= 100 ✅
- Safari iOS >= 15 ✅
- Edge Mobile >= 100 ✅
- Firefox Mobile >= 100 ✅

**移动端优化**：
- 自动适配竖屏和横屏
- 固定区域动态定位
- 卡片布局防重叠优化
- 详见 [移动端布局修复文档](LAYOUT_FIX_MOBILE.md)

## 代码组织

### style.css
样式文件按功能模块组织：
- CSS 变量定义
- 基础样式
- 固定区域样式（header、scroll-control）
- 卡片样式
- 响应式媒体查询

### script.js
JavaScript 代码按功能模块组织：
- 存储工具函数
- CSV 解析器
- 应用状态管理
- DOM 元素引用
- 视图切换功能
- 历史记录管理
- 文件处理
- 滚动控制
- 卡片渲染
- 主题管理
- 事件监听器
- 初始化逻辑

## 性能指标

### 大数据集优化（10,000 条）
- **初始加载**：< 200ms（仅渲染前 100 条）
- **内存占用**：降低 90%（20-30 MB vs 200-300 MB）
- **滚动帧率**：稳定 60 FPS
- **自动加载**：滚动到底部前 500px 自动加载下一批

### 智能跳转优化
- **远距离跳转**：< 300ms（例如从第 1 行跳到第 9000 行）
- **智能策略**：只渲染目标批次附近数据，避免渲染中间数据
- **性能提升**：10-20 倍速度提升
- **详见**：[智能跳转文档](SMART_JUMP_OPTIMIZATION.md)

### 交互响应
- 滚动响应时间：< 100ms
- 滚动动画时长：固定 500ms
- 跳转响应：智能加载到目标行
- 大数据集（≥ 5000 行）：自动即时跳转

详见：[性能优化文档](PERFORMANCE_OPTIMIZATION.md)

## 本地开发

无需构建步骤，直接修改文件后刷新浏览器即可看到效果。

## 常见问题

### Q: 导入大文件时提示 "localStorage quota exceeded" 错误？

**A**: 这是正常现象。浏览器的 localStorage 配额通常为 5-10MB，大文件（≥ 1MB）不会被保存到本地存储。

**解决方案**：
- 评分数据仍会保存（很小，不受影响）
- 每次需要重新选择 CSV 文件
- 或者将大文件拆分为多个小文件（< 1000 行）

详见：[localStorage 配额问题文档](LOCALSTORAGE_QUOTA_FIX.md)

### Q: 如何清理本地存储？

**A**: 在浏览器控制台执行：
```javascript
localStorage.clear();
```
或者在浏览器设置中清除网站数据。

### Q: CSV 文件需要什么格式？

**A**: 标准格式如下：
```csv
id,frequency,word,phoneticSymbol,definition,sentence
0,1000,abandon,/əˈbændən/,放弃,Don't abandon hope.
```

详见：[CSV 字段名访问文档](CSV_FIELD_NAME_ACCESS.md)

## License

MIT

